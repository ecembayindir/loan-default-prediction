<h1 align="center">Loan Default Prediction with Flask and MLflow</h1> <br/> <h2>ğŸš€ <strong>Objective</strong></h2> <p> This project aims to build a loan default prediction system using a pre-trained machine learning model deployed via a Flask web interface. It leverages Docker for containerization and AWS ECS Fargate for scalable deployment. Locally, MLflow tracks predictions, while the AWS deployment focuses on prediction functionality without MLflow logging, using a Random Forest or Logistic Regression model trained on financial data. </p> <h2>ğŸ›  Technology Stack</h2> <div class="badges"> <img src="https://img.shields.io/badge/Python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54" alt="Python"/> <img src="https://img.shields.io/badge/Flask-000000?style=for-the-badge&logo=flask&logoColor=white" alt="Flask"/> <img src="https://img.shields.io/badge/MLflow-0194E2?style=for-the-badge&logo=mlflow&logoColor=white" alt="MLflow"/> <img src="https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white" alt="Docker"/> <img src="https://img.shields.io/badge/AWS-232F3E?style=for-the-badge&logo=amazonaws&logoColor=white" alt="AWS"/> <img src="https://img.shields.io/badge/Scikit_learn-F7931E?style=for-the-badge&logo=scikit-learn&logoColor=white" alt="Scikit-learn"/> <img src="https://img.shields.io/badge/Pandas-150458?style=for-the-badge&logo=pandas&logoColor=white" alt="Pandas"/> <img src="https://img.shields.io/badge/NumPy-013243?style=for-the-badge&logo=numpy&logoColor=white" alt="NumPy"/> <img src="https://img.shields.io/badge/Gunicorn-499848?style=for-the-badge&logo=gunicorn&logoColor=white" alt="Gunicorn"/> </div> <h2>ğŸ“‚ <strong>Project Summary</strong></h2> <p> The Loan Default Prediction project deploys a machine learning model to predict loan default risk based on financial features like credit lines, loan amount, debt, income, employment years, and FICO score. It includes a Flask app for user interaction, MLflow for local prediction logging, and an AWS ECS deployment for production use. The system is designed for scalability and ease of deployment, with local MLflow tracking and robust error handling. </p> <h2>ğŸ“ˆ <strong>Methodology</strong></h2> <table style="width:100%; border-collapse: collapse; margin-bottom: 20px;"> <thead> <tr> <th style="background-color: #f2f2f2; border: 1px solid #ddd; padding: 8px;">Component</th> <th style="background-color: #f2f2f2; border: 1px solid #ddd; padding: 8px;">Description</th> </tr> </thead> <tbody> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Data Preprocessing</td> <td style="border: 1px solid #ddd; padding: 8px;">Normalizes financial features using mean and standard deviation from training data.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Model Training</td> <td style="border: 1px solid #ddd; padding: 8px;">Trains Logistic Regression and Random Forest models, selecting the best based on F1-score.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">Flask App</td> <td style="border: 1px solid #ddd; padding: 8px;">Serves a web interface and API endpoint for predictions.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">MLflow Tracking</td> <td style="border: 1px solid #ddd; padding: 8px;">Logs prediction inputs and outputs locally when MLflow server is available.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">AWS Deployment</td> <td style="border: 1px solid #ddd; padding: 8px;">Deploys the app on ECS Fargate without MLflow logging.</td> </tr> </tbody> </table> <h2>ğŸ” <strong>Implementation Details</strong></h2> <h3>ğŸ“‹ Data Preprocessing</h3> <table style="width:100%; border-collapse: collapse; margin-bottom: 20px;"> <thead> <tr> <th style="background-color: #f2f2f2; border: 1px solid #ddd; padding: 8px;">Step</th> <th style="background-color: #f2f2f2; border: 1px solid #ddd; padding: 8px;">Description</th> </tr> </thead> <tbody> <tr> <td style="border: 1px solid #ddd; padding: 8px;">1</td> <td style="border: 1px solid #ddd; padding: 8px;">Load raw data from `Loan_Data.csv`.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">2</td> <td style="border: 1px solid #ddd; padding: 8px;">Generate descriptive stats (`Loan_Data_Describe.csv`) for normalization.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">3</td> <td style="border: 1px solid #ddd; padding: 8px;">Save processed data as `Processed_Loan_Data.csv`.</td> </tr> <tr> <td style="border: 1px solid #ddd; padding: 8px;">4</td> <td style="border: 1px solid #ddd; padding: 8px;">Normalize features in `app.py` using precomputed stats.</td> </tr> </tbody> </table> <h3>ğŸ“Œ Model Development</h3> <ul> <li><strong>Logistic Regression</strong>: Balanced class weights, elasticnet penalty, saga solver.</li> <li><strong>Random Forest</strong>: 100 estimators, max depth 10, min samples split 5.</li> <li><strong>Selection</strong>: Best model (higher F1-score) saved as `best_model.pkl`.</li> <li><strong>Prediction</strong>: Returns probability and binary default label (threshold 0.5).</li> </ul> <h3>ğŸ“Œ Deployment</h3> <ul> <li><strong>Local</strong>: Flask app with MLflow logging to `http://localhost:8080`.</li> <li><strong>Docker</strong>: Containerized with Gunicorn, port 5001.</li> <li><strong>AWS ECS</strong>: Fargate deployment, no MLflow (hardcoded URI fails gracefully).</li> </ul> <h2>ğŸ“Š <strong>Key Features</strong></h2> <ul> <li><strong>Web Interface</strong>: User-friendly form for financial data input.</li> <li><strong>Prediction</strong>: Real-time default risk assessment.</li> <li><strong>Robustness</strong>: Error handling for MLflow failures and invalid inputs.</li> <li><strong>Scalability</strong>: Docker and AWS ECS for easy deployment.</li> </ul> <h2>ğŸ” <strong>Implementation Workflow</strong></h2> <ol> <li>Preprocess raw loan data and generate statistics.</li> <li>Train models with MLflow tracking and save the best model.</li> <li>Develop Flask app for prediction and local MLflow logging.</li> <li>Containerize the app with Docker.</li> <li>Deploy to AWS ECS Fargate for production use.</li> <li>Test predictions locally and on AWS.</li> </ol> <h2>ğŸ“š <strong>Dataset</strong></h2> <p> The project uses a custom <strong>Loan Data</strong> dataset with financial features and default labels. Itâ€™s not publicly hosted but can be replicated with similar data. </p> <ul> <li><strong>Features</strong>: `credit_lines_outstanding`, `loan_amt_outstanding`, `total_debt_outstanding`, `income`, `years_employed`, `fico_score`.</li> <li><strong>Target</strong>: `default` (0 or 1).</li> <li><strong>Size</strong>: User-provided (e.g., 10,000+ samples recommended).</li> <li><strong>Format</strong>: CSV, placed in `Data/Loan_Data.csv`.</li> </ul> <h2>ğŸ“¢ <strong>Conclusion</strong></h2> <p> This project delivers a functional loan default prediction system with a Flask interface, Dockerized for portability, and deployed on AWS ECS. Locally, MLflow enhances monitoring, while the AWS setup prioritizes prediction reliability over logging due to the hardcoded MLflow URI. Itâ€™s a practical example of MLOps with room for production enhancements like remote MLflow hosting. </p> <h2>Connect With Me</h2> <div align="center"> <a href="https://www.linkedin.com/in/ecembayindir" target="_blank"> <img src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&logo=linkedin&logoColor=white" alt="LinkedIn"/> </a> <a href="mailto:ecmbyndr@gmail.com"> <img src="https://img.shields.io/badge/Email-D14836?style=for-the-badge&logo=gmail&logoColor=white" alt="Email"/> </a> </div> <br> <p align="center">Â© 2025 Ecem Bayindir. All rights reserved.</p> <hr/> <p align="center"> <img src="https://komarev.com/ghpvc/?username=ecembayindir&repo=loan-default-prediction&label=Repository%20views&color=0e75b6&style=flat" alt="Repository Views"> </p>
